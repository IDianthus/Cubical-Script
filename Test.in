{"workspaces":{"d0sboots\sAdventure":{{"adventure_lib":{#package\sAdventure\sv3.0\n\n#abs(x)\s(\s(\s(\s{x}\s)\s^\s2.0\s)\s^\s0.5\s)\n\n#goRight\s(\scurPos\s+\s1.0\s)\n#goLeft\s(\scurPos\s-\s1.0\s)\n#goUp\s(\scurPos\s+\s19.0\s)\n#goDown\s(\scurPos\s-\s19.0\s)\n\n#xMove(d)\sif(\s{d}\s==\s\"L\",\s-1.0,\sternary.double(\s{d}\s==\s\"R\",\s1.0,\s0.0\s)\s)\n#yMove(d)\sif(\s{d}\s==\s\"U\",\s1.0,\sternary.double(\s{d}\s==\s\"D\",\s-1.0,\s0.0\s)\s)\n#move(d)\svec(\s{xMove({d})},\s{yMove({d})}\s)\n\n#posToVec(x)\svec(\s(\s{x}\s)\s%\s19.0,\sfloor(\s(\s{x}\s)\s/\s19.0\s)\s)\n#posToString(p)\ssub(\sd2s(\s(\s{p}\s)\s+\s1000.0\s),\s1,\s3)\n#firstElementPos\ss2d(\ssub(\squeue,\s0,\s3\s),\s-1.0\s)\n#firstElementDir\ssub(\squeue,\s3,\s1\s)\n\n#nextField(d)\s(\scurPos\s+\ss2d\s(\s\\\nsub(\s\"019\s-19\s-01\s001\",\sindex(\s\"U\s\s\sD\s\s\sL\s\s\sR\",\s{d},\s0\s),\s3\s),\s0.0\s)\s\\\n)\n#nextFieldInverse(d)\s(\scurPos\s+\ss2d\s(\s\\\nsub(\s\"-19\s019\s001\s-01\",\sindex(\"U\s\s\sD\s\s\sL\s\s\sR\",\s{d},\s0),\s3),\s0.0\s)\\\n)\n#replace(\sst,\si,\sval,\svalLen\s)\ssub(\s{st},\s0,\s{i}\s)\s.\s\\\n\s\s\s\s{val}\s.\s\\\n\s\s\s\ssub(\s{st},\s(\s{i}\s)\s+\s(\s{valLen}\s),\s99999\s)\n#pop\squeue\s=\ssub(\squeue,\s5,\s99999\s)\n#cur_difficulty\s{abs(\sx(\sadventure.roomCoords()\s)\s+\sy(\sadventure.roomCoords()\s)\s-\s254.0\s)}\n\n\n};\n"init":{:import\sadventure_lib\n\n:name\s{package}:init\n\n:global\sdouble\sleon.adventure.delay\n:global\sdouble\sleon.adventure.target_pos\n\n:global\sstring\sleon.adventure.path\n:global\sstring\sleon.adventure.targetPositions\n:global\sstring\sleon.adventure.room_direction\n\n:global\sint\sleon.adventure.running\n:global\sint\sleon.adventure.maxDifficulty\n\n:local\sint\smaxDifficultyInit\n\nkey.r()\nkey.i()\n\nisopen(\s\"arcade\"\s)\n\n\nmaxDifficultyInit\s=\s81\nleon.adventure.maxDifficulty\s=\sternary.int(\simpulse()\s==\s\"key.i\",\s\\\nmaxDifficultyInit,\s\\\nternary.int(\sleon.adventure.maxDifficulty\s==\s0,\\\nmaxDifficultyInit,\s\\\nleon.adventure.maxDifficulty\\\n)\s\\\n)\n\ngoto(\sternary.int(\simpulse()\s==\s\"key.i\",\s\\\nend,\s\\\nternary.int(\sleon.adventure.running\s!=\s0,\s\\\nstop,\s\\\nstart\s)\s\\\n\s\s\s\s)\s\\\n)\n\nstart:\nexecutesync(\s\"turbo\sstart\"\s)\ngis(\s\"<size=0>leon.adventure\",\s0)\nleon.adventure.running\s=\s1\nleon.adventure.target_pos\s=\s0.0\nleon.adventure.path\s=\s\"\"\nleon.adventure.targetPositions\s=\s\"\"\nleon.adventure.room_direction\s=\s\"\"\ngss(\s\"---Stop\shiding---\",\s\"<\size=0>\")\n\nloop:\nexecutesync(\s\"{package}:clear\sroom\"\s)\nleon.adventure.maxDifficulty\s=\sleon.adventure.maxDifficulty\s+\sif(\s\\\n{cur_difficulty}\s>=\si2d(\sleon.adventure.maxDifficulty\s)\s\\\n&&\sadventure.isCompleted(\sadventure.roomCoords()\s),\s\\\n2,\s\\\n0\s\\\n)\ngotoif(\sloop,\sleon.adventure.running\s==\s1\s)\nexecutesync(\s\"turbo\sstop\"\s)\n\nstop:\nleon.adventure.running\s=\s0\n\nend:\nwait(\s0.0\s)\n\n\n};\n"clear\sroom":{:import\sadventure_lib\n\n:name\s{package}:clear\sroom\n\n:global\sint\sleon.adventure.maxDifficulty\n\n:global\sstring\sleon.adventure.path\n:global\sstring\sleon.adventure.targetPositions\n\n:global\sstring\sleon.adventure.room_direction\n\n#nextRoomLower\sternary.string(\s\\\nx(\sadventure.roomCoords()\s)\s<\s127.0\s&&\sy(\sadventure.roomCoords()\s)\s>=\s127.0,\s\"R\",\sif(\s\\\nx(\sadventure.roomCoords()\s)\s>=\s127.0\s&&\sy(\sadventure.roomCoords()\s)\s>\s127.0,\s\"D\",\sif(\s\\\nx(\sadventure.roomCoords()\s)\s>\s127.0\s&&\sy(\sadventure.roomCoords()\s)\s<=\s127.0,\s\"L\",\s\\\n\"U\"\s\\\n))\\\n)\n#rotateLeft(x)\ssub(\s\"LDRU\",\sindex(\s\"ULDR\",\s{x},\s0\s),\s1\s)\n\nexecutesync(\s\"{package}:kill\senemies\"\s)\nexecutesync(\s\"{package}:farm\skeys\"\s)\n\nleon.adventure.room_direction\s=\sif(\s\\\n{cur_difficulty}\s==\s0.0\s&&\slen(\sleon.adventure.room_direction\s)\s>\s0,\s\\\n{rotateLeft(\sleon.adventure.room_direction\s)},\s\\\nif(\s\\\n(\si2d(\sadventure.playerAttack()\s)\s>=\sround(\s(\s{cur_difficulty}\s+\s1.0\s)\s*\s0.38\s+\s1.0\s)\s+\s\\\nround(\s(\s{cur_difficulty}\s+\s1.0\s)\s*\s0.08\s)\s\\\n||\si2d(\sadventure.playerArmor()\s)\s>=\sceil(\s(\s{cur_difficulty}\s+\s1.0\s)\s*\s0.39\s)\s)\s\\\n&&\si2d(\sleon.adventure.maxDifficulty\s)\s>=\s(\s{cur_difficulty}\s+\s1.0\s),\s\\\n{rotateLeft(\s{nextRoomLower}\s)},\s\\\n{nextRoomLower}\s\\\n)\s\\\n)\n\nleon.adventure.targetPositions\s=\ssub(\\\n\"351\s171\s189\s009\",\sindex(\s\"U\s\s\sL\s\s\sR\s\s\sD\",\sleon.adventure.room_direction,\s0),\s3\\\n)\s.\s\":\"\n\nexecutesync(\s\"{package}:find\sloot\"\s)\nleon.adventure.path\s=\sleon.adventure.room_direction\nexecutesync(\s\"{package}:follow\spath\"\s)\n\nend:\nwait(0.0)\n\n\n};\n"follow\spath":{:import\sadventure_lib\n\n:name\s{package}:follow\spath\n\n:global\sstring\sleon.adventure.path\n:global\sint\sleon.adventure.running\n\n:local\sint\sstepCount\n:local\sdouble\scurPos\n:local\sstring\sstatus\n\n#nextDirection\ssub(\sleon.adventure.path,\sstepCount,\s1\s)\n#nextMove\s{move({nextDirection})}\n\n#playerPos\sx(\sadventure.playerPos()\s)\s+\s19.0\s*\sy(\sadventure.playerPos()\s)\n#status\sadventure.entityType(\s{posToVec({nextField({nextDirection})})}\s)\n\nstepCount\s=\s-1\n\nloop:\nstepCount\s=\sstepCount\s+\s1\ngoto(\sternary.int(\sstepCount\s>=\slen(\sleon.adventure.path\s)\s||\sleon.adventure.running\s!=\s1,\send,\s\\\nternary.int(\s{nextDirection}\s==\s\"B\",\sbomb,\sternary.int(\s{nextDirection}\s==\s\"W\",\swait,\smove\s)))\s\\\n\s\s\s\s)\n\nmove:\ncurPos\s=\s{playerPos}\nstatus\s=\s{status}\n\nmove2:\nexecutesync(\s\"turbo\sstop\"\s)\nadventure.move(\s{nextMove}\s)\nexecutesync(\s\"turbo\sstart\"\s)\ngoto(\sternary.int(\scurPos\s!=\s{playerPos}\s||\sstatus\s!=\s{status},\sloop,\smove2\s)\s)\n\nbomb:\nexecutesync(\s\"turbo\sstop\"\s)\nadventure.placeBomb()\nexecutesync(\s\"turbo\sstart\"\s)\ngoto(\sloop\s)\n\nwait:\nexecutesync(\s\"turbo\sstop\"\s)\nadventure.wait()\nexecutesync(\s\"turbo\sstart\"\s)\ngoto(\sloop\s)\n\nend:\nwait(\s0.0\s)\n\n\n};\n"find\spath":{:import\sadventure_lib\n\n:name\s{package}:find\spath\n\n:global\sint\sturbo.cycles.max\n:global\sint\sturbo.cycles\n\n:global\sstring\sleon.adventure.path\n:global\sdouble\sleon.adventure.target_pos\n\n:local\sdouble\scurPos\n\n:local\sstring\squeue\n:local\sstring\sfield\n:local\sstring\spath\n\n#distance(\sx,\sy\s)\s(\s{x}\s%\s19.0\s)\s-\s(\s{y}\s%\s19.0\s)\s+\sfloor(\s{x}\s/\s19.0\s)\s-\sfloor(\s{y}\s/\s19.0\s)\n\nstart:\nturbo.cycles.max\s=\smax(\sturbo.cycles.max,\sturbo.cycles\s+\s4000\s)\nqueue\s=\s{posToString(\sx(\sadventure.playerPos()\s)\s+\s19.0\s*\sy\s(\sadventure.playerPos()\s)\s)}\s.\s\"S:\"\nfield\s=\s\"{lua(return\sstring.rep(\s\"0\",\s362\s)\s)}\"\n\nloop1:\ncurPos\s=\s{firstElementPos}\nfield\s=\s{replace(\sfield,\sd2i(\scurPos\s),\s{firstElementDir},\s1\s)}\n{pop}\n\nqueue\s=\squeue\s.\sif(\s\\\nadventure.isWall(\s{posToVec(\s{goUp}\s)}\s)\s==\sfalse\s&&\s\\\ncontains(\squeue,\s{posToString(\s{goUp}\s)}\s)\s==\sfalse\s&&\s\\\n{goUp}\s<\s361.0\s&&\s\\\nsub(\sfield,\sd2i(\s{goUp}\s),\s1)\s==\s\"0\",\s\\\nconcat(\s{posToString(\s{goUp}\s)},\s\"U:\"\s),\s\\\n\s\s\s\s\s\s\s\s\s\s\s\s\"\"\s\\\n)\s.\sif(\s\\\nadventure.isWall(\s{posToVec(\s{goDown}\s)}\s)\s==\sfalse\s&&\s\\\ncontains(\squeue,\s{posToString(\s{goDown}\s)}\s)\s==\sfalse\s&&\s\\\n{goDown}\s>=\s0.0\s&&\\\nsub(\sfield,\sd2i(\s{goDown}\s),\s1)\s==\s\"0\",\s\\\n{posToString(\s{goDown}\s)}\s.\s\"D:\",\s\\\n\"\"\s\\\n)\s.\sif(\s\\\n\s\s\s\sadventure.isWall(\s{posToVec(\s{goRight}\s)}\s)\s==\sfalse\s&&\s\\\ncontains(\squeue,\s{posToString(\s{goRight}\s)}\s)\s==\sfalse\s&&\s\\\nsub(\sfield,\sd2i(\s{goRight}\s),\s1)\s==\s\"0\"&&\\\n{distance({goRight},curPos)}\s<=\s1.0,\s\\\n{posToString(\s{goRight}\s)}\s.\s\"R:\",\s\\\n\"\"\\\n)\s.\sif(\s\\\nadventure.isWall(\s{posToVec(\s{goLeft}\s)}\s)\s==\sfalse\s&&\s\\\ncontains(\squeue,\s{posToString(\s{goLeft}\s)}\s)\s==\sfalse\s&&\s\\\nsub(\sfield,\sd2i(\s{goLeft}\s),\s1)\s==\s\"0\"\s&&\\\n{distance(\s{goLeft},\scurPos\s)}\s<=\s1.0,\s\\\n{posToString(\s{goLeft}\s)}\s.\s\"L:\",\s\\\n\"\"\\\n)\n\ngotoif(\sloop1,\slen(\squeue\s)\s>\s0\s&&\scurPos\s!=\sleon.adventure.target_pos\s)\n\nloop2:\npath\s=\ssub(\sfield,\sd2i(\scurPos\s),\s1)\s.\spath\ncurPos\s=\sif(\ssub(\spath,\s0,\s1)\s==\s\"U\",\s{goDown},\sif(\ssub(\spath,\s0,\s1)\s==\s\"D\",\s{goUp},\sif(\s\\\nsub(\spath,\s0,\s1)\s==\s\"R\",\s{goLeft},\sif(\ssub(\spath,\s0,\s1)\s==\s\"L\",\s{goRight},\scurPos\s)\s)\s)\s\\\n\s\s\s\s)\ngotoif(\sloop2,\ssub(\sfield,\sd2i(\scurPos\s),\s1)\s!=\s\"S\"\s)\nleon.adventure.path\s=\sif(\spath\s==\s\"S\",\s\"\",\spath)\nexecutesync(\s\"{package}:refine\spath\"\s)\n\nend:\nwait(0.0)\n\n\n};\n"refine\spath":{:import\sadventure_lib\n\n:name\s{package}:refine\spath\n\n:global\sstring\sleon.adventure.path\n\n:local\sstring\spath\n:local\sdouble\scurPos\n:local\sint\sstepCount\n\n#nextVec(d)\s{posToVec(\scurPos\s)}\s+\svec(\s\\\ns2d(\ssub(\s\"1102\",\sindex(\s\"UDLR\",\s{d},\s0),\s1),\s0.0),\s\\\ns2d(\ssub(\s\"2011\",\sindex(\s\"UDLR\",\s{d},\s0),\s1),\s0.0)\s\\\n)\s-\svec(\s1.0,\s1.0\s)\n#curDirection\ssub(\spath,\sstepCount,\s1)\n\n#insert(\sst,\si,\sval)\ssub(\s{st},\s0,\s{i}\s)\s.\s(\s{val}\s)\s.\ssub(\s{st},\s{i},\s99999)\n\n#inverse(d)\sternary.string(\s{d}\s==\s\"U\",\s\\\n\"D\",\s\\\nternary.string(\s{d}\s==\s\"D\",\s\\\n\"U\",\s\\\nternary.string(\s{d}\s==\s\"R\",\s\\\n\"L\",\s\\\n\"R\"\s\\\n)\\\n)\\\n)\n\n#getEntity(pos)\sadventure.entityType(\s{posToVec(\s{pos}\s)}\s)\n#getCurrentEntity\sadventure.entityType(\s{nextVec(\s{curDirection}\s)}\s)\n#escapeDirection\sif(\s\\\n{getEntity(\s{goUp}\s)}\s==\s\"\"\s&&\s\\\n{getEntity(\scurPos\s+\s19.0\s*\s2.0\s)}\s==\s\"\"\s&&\s\\\nadventure.isWall(\s{posToVec(\s{goUp}\s)}\s)\s==\sfalse\s&&\\\n{goUp}\s!=\s351.0,\s\\\n\s\s\s\s\s\s\s\s\s\s\s\s\"BUUWDD\",\s\\\nif(\s\\\n{getEntity({goDown})}==\"\"\s&&\s\\\n{getEntity(curPos\s-\s19.\s*\s2.)}\s==\s\"\"\s&&\s\\\nadventure.isWall({posToVec(\s{goDown}\s)}\s)\s==\sfalse\s&&\s\\\n{goDown}\s!=\s9.0,\s\\\n\"BDDWUU\",\s\\\nif(\\\n{getEntity({goLeft})}\s==\s\"\"\s&&\s\\\n{getEntity(curPos\s-\s2.)}\s==\s\"\"\s&&\s\\\nadventure.isWall({posToVec({goLeft})})\s==\sfalse\s&&\s\\\n{goLeft}\s!=\s171.,\s\\\n\"BLLWRR\",\s\\\n\"BRRWLL\"\s\\\n)\s\\\n)\s\\\n)\n\nstart:\ncurPos\s=\sx(\sadventure.playerPos()\s)\s+\s19.0\s*\sy(\sadventure.playerPos()\s)\nstepCount\s=\s0\npath\s=\sleon.adventure.path\n\nloop:\ngoto(\sif(\sstepCount\s>=\slen(\spath\s),\send,\sif(\s{getCurrentEntity}\s==\s\"Door\",\sdoor,\s\\\nif(\s{getCurrentEntity}\s==\s\"Rock\",\sif(\sadventure.hasItem(\"hammer\"),\sdoor,\srock\s),\snextTile))\s\\\n))\n\nrock:\npath\s=\s{insert(\spath,\sstepCount,\sif(\sadventure.hasItem(\s\"eodArmor\"\s),\s\"BWWW\",\s{escapeDirection}\s)\s)}\nstepCount\s=\sstepCount\s+\sif(\sadventure.hasItem(\s\"eodArmor\"\s),\s4,\s6)\ngoto(\snextTile\s)\n\ndoor:\npath\s=\s{insert(\spath,\sstepCount,\s{curDirection}\s)}\nstepCount\s=\sstepCount\s+\s1\n\nnextTile:\ncurPos\s=\s{nextField(\s{curDirection}\s)}\nstepCount\s=\sstepCount\s+\s1\ngoto(\sloop\s)\n\nend:\nleon.adventure.path\s=\spath\nwait(\s0.0\s)\n\n\n};\n"kill\senemies":{:import\sadventure_lib\n\n:name\s{package}:kill\senemies\n\n#enemies_alive\s({lua(\s\\\nlocal\spositions\s=\s{}\s\\\nlocal\scounter\s=\s1\s\\\nfor\sx\s=\s1,\s17,\s1\sdo\s\\\nfor\sy\s=\s1,\s17,\s1\sdo\s\\\nif\snot(\sx\s%\s2\s==\s0\sand\sy\s%\s2\s==\s0\s)\sthen\s\\\npositions[\scounter\s]\s=\s\"adventure.isEnemy(\svec(\s\"..x..\".,\"..y..\".)\s)\"\s\\\ncounter\s=\scounter\s+\s1\s\\\nend\s\\\nend\s\\\nend\s\\\npositions[\scounter\s]\s=\s\"adventure.isEnemy(\svec(\s0.0,\s9.0\s)\s)\"\s\\\npositions[\scounter\s+\s1\s]\s=\s\"adventure.isEnemy(\svec(\s9.0,\s0.0\s)\s)\"\s\\\npositions[\scounter\s+\s2\s]\s=\s\"adventure.isEnemy(\svec(\s9.0,\s18.0\s)\s)\"\s\\\npositions[\scounter\s+\s3\s]\s=\s\"adventure.isEnemy(\svec(\s18.0,\s9.0\s)\s)\"\s\\\nreturn\stable.concat(\spositions,\s\"||\")\s)}\s)\n\n#enemyInDir(\sx,\sy\s)\sadventure.isEnemy(\sadventure.playerPos()\s+\svec(\s{x},\s{y}\s)\s)\n#enemyDirection\sif(\s{enemyInDir(\s0.0,\s1.0\s)},\s\"U\",\sif(\s\\\n{enemyInDir(\s1.0,\s0.0\s)},\s\"R\",\sif(\s\\\n\s\s\s\s{enemyInDir(\s0.0,\s-1.0\s)},\s\"D\",\sif(\s\\\n\s\s\s\s{enemyInDir(\s-1.0,\s0.0\s)},\s\"L\",\s\"W\"\s)))\s\\\n\s\s\s\s)\n\nkey.k()\n\nisopen(\"arcade\")\n\ngotoif(\sstart,\simpulse()\s!=\s\"key.k\"\s)\nexecutesync(\s\"turbo\sstart\"\s)\n\nstart:\ngoto(\sternary.int(\s{enemies_alive},\swait,\sternary.int(\simpulse()\s==\s\"key.k\",\sstop,\send\s)\s)\s)\n\nwait:\nexecutesync(\s\"turbo\sstop\"\s)\nadventure.wait()\nexecutesync(\s\"turbo\sstart\"\s)\ngotoif(\swait,\s{enemyDirection}\s==\s\"W\"\s)\n\nattack:\nexecutesync(\s\"turbo\sstop\"\s)\nadventure.move(\s{move(\s{enemyDirection}\s)}\s)\nexecutesync(\s\"turbo\sstart\"\s)\ngoto(\sternary.int(\s{enemyDirection}\s!=\s\"W\",\sattack,\sstart\s)\s)\n\nstop:\nexecutesync(\s\"turbo\sstop\"\s)\n\nend:\nwait(\s0.0\s)\n\n\n};\n"find\sloot":{:import\sadventure_lib\n:name\s{package}:find\sloot\n\n:global\sint\sturbo.cycles.max\n:global\sint\sturbo.cycles\n\n:global\sstring\sleon.adventure.targetPositions\n:global\sdouble\sleon.adventure.target_pos\n:global\sint\sleon.adventure.running\n:global\sint\sleon.adventure.maxDifficulty\n\nkey.u()\nkey.j()\n\nisopen(\"arcade\")\n\nleon.adventure.maxDifficulty\s=\sleon.adventure.maxDifficulty\s+\sif(\s\\\nimpulse()\s==\s\"key.j\",\s-1,\sif(\simpulse()\s==\s\"key.u\",\s1,\s0\s)\s\\\n)\ngotoif(\send,\scontains(\simpulse(),\s\"key.\"\s)\s)\n\nstart:\nturbo.cycles.max\s=\smax(\sturbo.cycles.max,\sturbo.cycles\s+\s4000\s)\nexecutesync(\s\"{package}:analyze\sloot\"\s)\n\nloop:\nleon.adventure.target_pos\s=\ss2d(\ssub(\sleon.adventure.targetPositions,\s0,\s3\s),\s0.0\s)\nleon.adventure.targetPositions\s=\ssub(\sleon.adventure.targetPositions,\s4,\s99999\s)\nexecutesync(\s\"{package}:find\spath\"\s)\nexecutesync(\s\"{package}:follow\spath\"\s)\ngotoif(\sloop,\slen(\sleon.adventure.targetPositions\s)\s>\s0\s&&\sleon.adventure.running\s>\s0\s)\n\nend:\nwait(\s0.0\s)\n\n\n};\n"farm\skeys":{:import\sadventure_lib\n\n:name\s{package}:farm\skeys\n\n:global\sstring\sleon.adventure.path\n:global\sint\sleon.adventure.running\n\n:local\sint\scurPos\n\nstart:\ncurPos\s=\sd2i(\sx(\sadventure.playerPos()\s)\s)\s+\sa.i(\s19,\s\"*\",\sd2i(\sy(\sadventure.playerPos()\s)\s)\s)\ngotoif(\send,\s\\\nadventure.keys()\s>\s10\s||\s(\s\\\n(\scurPos\s!=\s9\s&&\scurPos\s!=\s189\s)\s&&\s(\scurPos\s!=\s171\s&&\scurPos\s!=\s351\s)\s\\\n)\s||\sleon.adventure.running\s!=\s1\s\\\n)\nleon.adventure.path\s=\s\\\nternary.string(\scurPos\s==\s9,\s\"D\",\s\\\nternary.string(\scurPos\s==\s171,\s\"L\",\s\\\nternary.string(\scurPos\s==\s189,\s\"R\",\s\"U\"\s)\s\\\n)\s\\\n)\nexecutesync(\s\"leon.adventure:follow\spath\"\s)\nexecutesync(\s\"leon.adventure:kill\senemies\"\s)\nleon.adventure.path\s=\s\\\nternary.string(\scurPos\s==\s9,\s\"U\",\s\\\nternary.string(\scurPos\s==\s171,\s\"R\",\s\\\nternary.string(\scurPos\s==\s189,\s\"L\",\s\"D\"\s)\s\\\n)\s\\\n)\nexecutesync(\s\"leon.adventure:follow\spath\"\s)\nexecutesync(\s\"leon.adventure:kill\senemies\"\s)\ngoto(\sstart\s)\n\nend:\nwait(\s0.0\s)\n\n\n};\n"analyze\sloot":{:import\sadventure_lib\n\n:name\s{package}:analyze\sloot\n\n:global\sstring\sleon.adventure.targetPositions\n\n:local\sstring\sfield\n:local\sstring\squeue\n:local\sstring\sinsertPosition\n:local\sstring\slootPositions\n:local\sdouble\scurPos\n:local\sdouble\stargetPos\n\n#toQueueElement(\spos,\sdir\s)\s{posToString(\s{pos}\s)}\s.\s{dir}\s.\s\":\"\n#enqueue(\spos,\sdir\s)\squeue\s=\squeue\s.\s{toQueueElement(\s{pos},\s{dir}\s)}\n\n{enqueue(\sx(\sadventure.playerPos()\s)\s+\s19.0\s*\sy(\sadventure.playerPos()\s),\s\"S\"\s)}\nfield\s=\s\"{lua(\sreturn\sstring.rep(\s\"0000\",\s362\s)\s)}\"\n\nloop1:\ncurPos\s=\s{firstElementPos}\nfield\s=\s{replace(\sfield,\sd2i(\scurPos\s)\s*\s4,\s{firstElementDir},\s1\s)}\n{pop}\nqueue\s=\squeue\s.\sif(\s\\\nadventure.isWall(\s{posToVec(\s{goUp}\s)}\s)\s==\sfalse\s&&\s\\\ncontains(\squeue,\s{posToString(\s{goUp}\s)}\s)\s==\sfalse\s&&\s\\\n{goUp}\s<\s361.0\s&&\s\\\nsub(\sfield,\sd2i(\s{goUp}\s)\s*\s4,\s1\s)\s==\s\"0\"\s,\\\n{posToString(\s{goUp}\s)}\s.\s\"U:\",\s\\\n\"\"\s\\\n)\s.\sif(\s\\\nadventure.isWall(\s{posToVec(\s{goDown}\s)}\s)\s==\sfalse\s&&\s\\\ncontains(\squeue,\s{posToString(\s{goDown}\s)}\s)\s==\sfalse\s&&\s\\\n{goDown}\s>=\s0.0\s&&\s\\\nsub(\sfield,\sd2i(\s{goDown}\s)\s*\s4,\s1\s)\s==\s\"0\"\s,\s\\\n{posToString(\s{goDown}\s)}\s.\s\"D:\",\s\\\n\"\"\s\\\n)\s.\sif(\s\\\nadventure.isWall(\s{posToVec(\s{goRight}\s)}\s)\s==\sfalse\s&&\s\\\ncontains(\squeue,\s{posToString(\s{goRight}\s)}\s)\s==\sfalse\s&&\s\\\nsub(\sfield,\sd2i(\s{goRight}\s)\s*\s4,\s1\s)\s==\s\"0\"\s&&\s\\\nfloor(\s{goRight}\s/\s19.0\s)\s==\sfloor(\scurPos\s/\s19.0\s),\s\\\n{posToString(\s{goRight}\s)}\s.\s\"R:\",\s\\\n\"\"\s\\\n)\s.\sif(\s\\\nadventure.isWall(\s{posToVec(\s{goLeft}\s)}\s)\s==\sfalse\s&&\s\\\ncontains(\squeue,\s{posToString(\s{goLeft}\s)}\s)\s==\sfalse\s&&\s\\\nsub(\sfield,\sd2i(\s{goLeft}\s)\s*\s4,\s1\s)\s==\s\"0\"\s&&\s\\\nfloor(\s{goLeft}\s/\s19.0\s)\s==\sfloor(\scurPos\s/\s19.0\s),\s\\\n{posToString(\s{goLeft}\s)}\s.\s\"L:\",\s\\\n\"\"\s\\\n)\nlootPositions\s=\sif(\sadventure.entityType(\s{posToVec(\scurPos\s)}\s)\s==\s\"Chest\",\s\\\n{posToString(curPos)}\s.\s\":\",\\\n\"\"\s\\\n)\s.\slootPositions\ngotoif(\sloop1,\slen(\squeue\s)\s>\s0\s)\nlootPositions\s=\sleon.adventure.targetPositions\s.\slootPositions\n\nloop2:\ntargetPos\s=\ss2d(\ssub(\slootPositions,\s0,\s3\s),\s0.0\s)\ncurPos\s=\stargetPos\nlootPositions\s=\ssub(\slootPositions,\s4,\s99999\s)\n\ninnerLoop2:\nleon.adventure.targetPositions\s=\sif(\s\\\nsub(\sfield,\sd2i(\s{nextFieldInverse(\ssub(\sfield,\sd2i(\scurPos\s)\s*\s4,\s1\s)\s)}\s)\s*\s4,\s1\s)\s==\s\"S\"\s\\\n&&\scontains(\sleon.adventure.targetPositions,\s{posToString(\stargetPos\s)}\s),\s\\\n{posToString(\stargetPos\s)}\s.\s\":\"\s.\sleon.adventure.targetPositions,\s\\\nif(\s\\\ncontains(\sleon.adventure.targetPositions,\s{posToString(\stargetPos\s)}\s)\s==\sfalse\s&&\s\\\nsub(\sfield,\sd2i(\scurPos\s)\s*\s4\s+\s1,\s3\s)\s!=\s\"000\",\s\\\nsub(\sleon.adventure.targetPositions,\s\\\n0,\s\\\nindex(\sleon.adventure.targetPositions,\s\\\nsub(\sfield,\sd2i(\scurPos\s)\s*\s4\s+\s1,\s3\s),\s0\s)\s\\\n)\s.\s{posToString(\stargetPos\s)}\s.\s\":\"\s.\ssub(\s\\\nleon.adventure.targetPositions,\s\\\nindex(\sleon.adventure.targetPositions,\s\\\nsub(\sfield,\sd2i(\scurPos\s)\s*\s4\s+\s1,\s3),\s\\\n0),\s\\\n99999\s\\\n),\s\\\nleon.adventure.targetPositions\s\\\n)\s\\\n)\nfield\s=\sif(\scontains(\sleon.adventure.targetPositions,\s{posToString(\stargetPos\s)}\s)\s==\sfalse\s\\\n||\slen(\sleon.adventure.targetPositions\s)\s<=\s4\s\\\n\s\s\s\s\s\s\s\s||\ssub(\sfield,\sd2i(\scurPos\s)\s*\s4\s+\s1,\s3\s)\s==\ssub(\sleon.adventure.targetPositions,\s\\\nindex(\sleon.adventure.targetPositions,\s{posToString(\stargetPos\s)},\s0\s)\s+\s4,\s3\s\\\n),\s\\\n{replace(\sfield,\sd2i(\scurPos\s)\s*\s4\s+\s1,\s{posToString(\stargetPos\s)},\s3\s)},\s\\\nfield\s\\\n)\ncurPos\s=\s{nextFieldInverse(\ssub(\sfield,\sd2i(\scurPos\s)\s*\s4,\s1\s)\s)}\ngoto(\sif(\ssub(\sfield,\sd2i(\scurPos\s)\s*\s4,\s1\s)\s!=\s\"S\",\sinnerLoop2,\s\\\nif(\slen(\slootPositions\s)\s>\s0,\sloop2,\send\s)\s)\s\\\n)\n\nend:\nwait(\s0.0\s)\n\n}}}}}