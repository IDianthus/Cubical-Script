{\n"workspaces":{\n"d0sboots\sAdventure":{\n{\n"adventure_lib":{\n\n#package\sAdventure\sv3.0\n\n\n#abs(\nx\s\\n)\s(\n(\n(\n{\nx}\s\\n)^2.\s\\n)^0.5\s\\n)\n\n#goRight\s(\ncurPos\s+\s1.\s\\n)\n\n#goLeft\s(\ncurPos\s-\s1.\s\\n)\n\n#goUp\s(\ncurPos\s+\s19.\s\\n)\n\n#goDown\s(\ncurPos\s-\s19.\s\\n)\n\n\n#xMove(\nd\s\\n)\sif(\n{\nd}==\"L\",\s\\n-1.,\s\\nternary.double(\n{\nd}==\"R\",\s\\n1.,\s\\n0.\s\\n)\s\\n)\n\n#yMove(\nd\s\\n)\sif(\n{\nd}==\"U\",\s\\n1.,\s\\nternary.double(\n{\nd}==\"D\",\s\\n-1.,\s\\n0.\s\\n)\s\\n)\n\n#move(\nd\s\\n)\svec(\n{\nxMove(\n{\nd}\s\\n)},\n{\nyMove(\n{\nd}\s\\n)}\s\\n)\n\n\n#posToVec(\nx\s\\n)\svec(\n(\n{\nx}\s\\n)%19.,\s\\nfloor(\n(\n{\nx}\s\\n)/19.\s\\n)\s\\n)\n\n#posToString(\np\s\\n)\ssub(\nd2s(\n(\n{\np}\s\\n)\s+\s1000.\s\\n),\s\\n1,\s\\n3\s\\n)\n\n#firstElementPos\ss2d(\nsub(\nqueue,\s\\n0,\s\\n3\s\\n),\s\\n-1.\s\\n)\n\n#firstElementDir\ssub(\nqueue,\s\\n3,\s\\n1\s\\n)\n\n#nextField(\nd\s\\n)\s(\ncurPos\s+\ss2d(\nsub(\n\"019\s-19\s-01\s001\",\s\\nindex(\n\"U\sD\sL\sR\",\s\\n{\nd},\n\s\\n0\s\\n),\s\\n3\s\\n),\s\\n0.\s\\n)\s\\n)\n\n#nextFieldInverse(\nd\s\\n)\s(\ncurPos\s+\ss2d(\nsub(\n\"-19\s019\s001\s-01\",\s\\nindex(\n\"U\sD\sL\sR\",\s\\n{\nd},\n\s\\n0\s\\n),\s\\n3\s\\n),\s\\n0.\s\\n)\s\\n)\n\n#replace(\nst,\s\\ni,\s\\nval,\s\\nvalLen\s\\n)\ssub(\n{\nst},\n\s\\n0,\s\\n{\ni}\s\\n)\s.\s\\\n\s{\nval}\s.\s\\\n\ssub(\n{\nst},\n\s\\n(\n{\ni}\s\\n)\s+\s(\n{\nvalLen}\s\\n),\s\\n99999\s\\n)\n\n#pop\squeue=sub(\nqueue,\s\\n5,\s\\n99999\s\\n)\n\n#cur_difficulty\s{\nabs(\nx(\nadventure.roomCoords(\n\s\\n)\s\\n)\s+\sy(\nadventure.roomCoords(\n\s\\n)\s\\n)\s-\s254.\s\\n)}},\n{\n"init":{\n:import\sadventure_lib\n:name\s{\npackage}:init\n\n:global\sdouble\sleon.adventure.delay\n:global\sdouble\sleon.adventure.target_pos\n:global\sstring\sleon.adventure.path\n:global\sint\sleon.adventure.running\n:global\sint\sleon.adventure.maxDifficulty\n:global\sstring\sleon.adventure.targetPositions\n:global\sstring\sleon.adventure.room_direction\n:local\sint\smaxDifficultyInit\n\nkey.r(\n\s\\n)\nkey.i(\n\s\\n)\n\nisopen(\n\"arcade\"\s\\n)\n\n\nmaxDifficultyInit\s=\s81\nleon.adventure.maxDifficulty\s=\sternary.int(\nimpulse(\n\s\\n)==\"key.i\",\s\\nmaxDifficultyInit,\s\\nternary.int(\nleon.adventure.maxDifficulty\s==\s0,\s\\nmaxDifficultyInit,\s\\nleon.adventure.maxDifficulty\s\\n)\s\\n)\n\ngoto(\nternary.int(\nimpulse(\n\s\\n)==\"key.i\",\s\\nend,\s\\nternary.int(\nleon.adventure.running\s!=\s0,\s\\nstop,\s\\nstart\s\\n)\s\\n)\s\\n)\nstart:\nexecutesync(\n\"turbo\sstart\"\s\\n)\ngis(\n\"<size=0>leon.adventure\",\s\\n0\s\\n)\nleon.adventure.running\s=\s1\nleon.adventure.target_pos\s=\s0.\nleon.adventure.path\s=\s\"\"\nleon.adventure.targetPositions\s=\s\"\"\nleon.adventure.room_direction\s=\s\"\"\ngss(\n\"---Stop\shiding---\",\s\\n\"</size=0>\"\s\\n)\nloop:\nexecutesync(\n\"{\npackage}:clear\sroom\"\s\\n)\nleon.adventure.maxDifficulty\s=\sleon.adventure.maxDifficulty\s+\sif(\n{\ncur_difficulty}>=i2d(\nleon.adventure.maxDifficulty\s\\n)\s&&\sadventure.isCompleted(\nadventure.roomCoords(\n\s\\n)\s\\n),\s\\n2,\s\\n0\s\\n)\ngotoif(\nloop,\s\\nleon.adventure.running==1\s\\n)\nexecutesync(\n\"turbo\sstop\"\s\\n)\nstop:\nleon.adventure.running\s=\s0\nend:\nwait(\n0.\s\\n)},\n{\n"clear\sroom":{\n:import\sadventure_lib\n:name\s{\npackage}:clear\sroom\n\n:global\sint\sleon.adventure.maxDifficulty\n:global\sstring\sleon.adventure.path\n:global\sstring\sleon.adventure.targetPositions\n\n:global\sstring\sleon.adventure.room_direction\n\n\n#nextRoomLower\sternary.string(\n\\\n\sx(\nadventure.roomCoords(\n\s\\n)\s\\n)\s<\s127.0\s&&\sy(\nadventure.roomCoords(\n\s\\n)\s\\n)\s>=127.0,\s\\n\"R\",\s\\nif(\n\\\n\sx(\nadventure.roomCoords(\n\s\\n)\s\\n)\s>=\s127.0\s&&\sy(\nadventure.roomCoords(\n\s\\n)\s\\n)\s>127.0,\s\\n\"D\",\s\\nif(\n\s\\\n\sx(\nadventure.roomCoords(\n\s\\n)\s\\n)\s>\s127.0\s&&\sy(\nadventure.roomCoords(\n\s\\n)\s\\n)\s<=127.0,\s\\n\"L\",\s\\n\\\n\s\"U\"\s\\\n\s\s\\n)\s\\n)\s\\n)\n\n#rotateLeft(\nx\s\\n)\ssub(\n\"LDRU\",\s\\nindex(\n\"ULDR\",\s\\n{\nx},\n\s\\n0\s\\n),\s\\n1\s\\n)\n\nexecutesync(\n\"{\npackage}:kill\senemies\"\s\\n)\nexecutesync(\n\"{\npackage}:farm\skeys\"\s\\n)\n\nleon.adventure.room_direction\s=\sif(\n\s\\\n\s{\ncur_difficulty}==0.\s&&\slen(\nleon.adventure.room_direction\s\\n)>0,\s\\n{\nrotateLeft(\nleon.adventure.room_direction\s\\n)}\\\n\s,\s\\nif(\n(\ni2d(\nadventure.playerAttack(\n\s\\n)\s\\n)\s>=\sround(\n(\n{\ncur_difficulty}+1.\s\\n)*0.38+1.\s\\n)+round(\n(\n{\ncur_difficulty}+1.\s\\n)*0.08\s\\n)\s\\\n\s||\si2d(\nadventure.playerArmor(\n\s\\n)\s\\n)\s>=\sceil(\n(\n{\ncur_difficulty}+1.\s\\n)*0.39\s\\n)\s\\n)&&\s\\\n\si2d(\nleon.adventure.maxDifficulty\s\\n)\s>=\s(\n{\ncur_difficulty}+1.\s\\n)\\\n\s,\s\\n{\nrotateLeft(\n{\nnextRoomLower}\s\\n)},\n{\nnextRoomLower}\s\\n)\s\\n)\n\nleon.adventure.targetPositions\s=\ssub(\n\\\n\s\"351\s171\s189\s009\",\s\\n\\\n\sindex(\n\"U\sL\sR\sD\",\s\\nleon.adventure.room_direction,\s\\n0\s\\n),\s\\n\\\n\s3\\\n\s\\n)\s.\s\":\"\n\nexecutesync(\n\"{\npackage}:find\sloot\"\s\\n)\nleon.adventure.path=leon.adventure.room_direction\nexecutesync(\n\"{\npackage}:follow\spath\"\s\\n)\nend:\nwait(\n0.\s\\n)},\n{\n"follow\spath":{\n:import\sadventure_lib\n:name\s{\npackage}:follow\spath\n\n:global\sstring\sleon.adventure.path\n:global\sint\sleon.adventure.running\n\n:local\sint\sstepCount\n:local\sdouble\scurPos\n:local\sstring\sstatus\n\n\n#nextDirection\ssub(\nleon.adventure.path,\s\\nstepCount,\s\\n1\s\\n)\n\n#nextMove\s{\nmove(\n{\nnextDirection}\s\\n)}\n\n\n#playerPos\sx(\nadventure.playerPos(\n\s\\n)\s\\n)+19.*y(\nadventure.playerPos(\n\s\\n)\s\\n)\n\n#status\sadventure.entityType(\n{\nposToVec(\n{\nnextField(\n{\nnextDirection}\s\\n)}\s\\n)}\s\\n)\n\nstepCount\s=\s-1\nloop:\nstepCount+=1\ngoto(\nternary.int(\nstepCount>=len(\nleon.adventure.path\s\\n)||leon.adventure.running!=1,\s\\nend,\s\\nternary.int(\n{\nnextDirection}==\"B\",\s\\nbomb,\s\\nternary.int(\n{\nnextDirection}==\"W\",\s\\nwait,\s\\nmove\s\\n)\s\\n)\s\\n)\s\\n)\nmove:\n\scurPos\s=\s{\nplayerPos}\n\sstatus\s=\s{\nstatus}\n\smove2:\n\sexecutesync(\n\"turbo\sstop\"\s\\n)\n\sadventure.move(\n{\nnextMove}\s\\n)\n\sexecutesync(\n\"turbo\sstart\"\s\\n)\n\sgoto(\nternary.int(\ncurPos!={\nplayerPos}||status!={\nstatus},\n\s\\nloop,\s\\nmove2\s\\n)\s\\n)\nbomb:\n\sexecutesync(\n\"turbo\sstop\"\s\\n)\n\sadventure.placeBomb(\n\s\\n)\n\sexecutesync(\n\"turbo\sstart\"\s\\n)\n\sgoto(\nloop\s\\n)\nwait:\n\sexecutesync(\n\"turbo\sstop\"\s\\n)\n\sadventure.wait(\n\s\\n)\n\sexecutesync(\n\"turbo\sstart\"\s\\n)\n\sgoto(\nloop\s\\n)\nend:\nwait(\n0.\s\\n)},\n{\n"find\spath":{\n:import\sadventure_lib\n:name\s{\npackage}:find\spath\n\n:global\sstring\sleon.adventure.path\n:global\sdouble\sleon.adventure.target_pos\n:global\sint\sturbo.cycles.max\n:global\sint\sturbo.cycles\n\n:local\sdouble\scurPos\n:local\sstring\squeue\n:local\sstring\sfield\n:local\sstring\spath\n\n\n#distance(\nx,\s\\ny\s\\n)\s(\n{\nx}%19.\s\\n)-(\n{\ny}%19.\s\\n)+floor(\n{\nx}/19.\s\\n)-floor(\n{\ny}/19.\s\\n)\n\nstart:\nturbo.cycles.max\s=\smax(\nturbo.cycles.max,\s\\nturbo.cycles\s+\s4000\s\\n)\nqueue\s=\s{\nposToString(\nx(\nadventure.playerPos(\n\s\\n)\s\\n)\s+\s19.\s*\sy(\nadventure.playerPos(\n\s\\n)\s\\n)\s\\n)}\s.\s\"S:\"\nfield\s=\s\"{\nlua(\nreturn\sstring.rep(\n\"0\",\s\\n362\s\\n)\s\\n)}\"\nloop1:\n\scurPos\s=\s{\nfirstElementPos}\n\sfield\s=\s{\nreplace(\nfield,\s\\nd2i(\ncurPos\s\\n),\s\\n{\nfirstElementDir},\n\s\\n1\s\\n)}\n\s{\npop}\n\squeue=\squeue\s.\\\n\sif(\nfalse\s==\sadventure.isWall(\n{\nposToVec(\n{\ngoUp}\s\\n)}\s\\n)\s&&\s\\\n\sfalse\s==\scontains(\nqueue,\s\\n{\nposToString(\n{\ngoUp}\s\\n)}\s\\n)\s&&\s\\\n\s{\ngoUp}<361.\s&&\\\n\ssub(\nfield,\s\\nd2i(\n{\ngoUp}\s\\n),\s\\n1\s\\n)==\"0\"\s,\s\\n\\\n\sconcat(\n{\nposToString(\n{\ngoUp}\s\\n)},\n\s\\n\"U:\"\s\\n),\s\\n\"\"\s\\n)\s.\\\n\sif(\nfalse\s==\sadventure.isWall(\n{\nposToVec(\n{\ngoDown}\s\\n)}\s\\n)\s&&\s\\\n\sfalse\s==\scontains(\nqueue,\s\\n{\nposToString(\n{\ngoDown}\s\\n)}\s\\n)\s&&\s\\\n\s{\ngoDown}>=0.\s&&\\\n\ssub(\nfield,\s\\nd2i(\n{\ngoDown}\s\\n),\s\\n1\s\\n)==\"0\"\s,\s\\n\\\n\s{\nposToString(\n{\ngoDown}\s\\n)}\s.\s\"D:\",\s\\n\"\"\s\\n)\s.\\\n\sif(\nfalse\s==\sadventure.isWall(\n{\nposToVec(\n{\ngoRight}\s\\n)}\s\\n)\s&&\s\\\n\sfalse\s==\scontains(\nqueue,\s\\n{\nposToString(\n{\ngoRight}\s\\n)}\s\\n)\s&&\s\\\n\ssub(\nfield,\s\\nd2i(\n{\ngoRight}\s\\n),\s\\n1\s\\n)==\"0\"&&\\\n\s{\ndistance(\n{\ngoRight},\n\s\\ncurPos\s\\n)}<=1.,\s\\n\\\n\s{\nposToString(\n{\ngoRight}\s\\n)}\s.\s\"R:\",\s\\n\"\"\s\\n)\s.\\\n\sif(\nfalse\s==\sadventure.isWall(\n{\nposToVec(\n{\ngoLeft}\s\\n)}\s\\n)\s&&\s\\\n\sfalse\s==\scontains(\nqueue,\s\\n{\nposToString(\n{\ngoLeft}\s\\n)}\s\\n)\s&&\s\\\n\ssub(\nfield,\s\\nd2i(\n{\ngoLeft}\s\\n),\s\\n1\s\\n)\s==\s\"0\"&&\\\n\s{\ndistance(\n{\ngoLeft},\n\s\\ncurPos\s\\n)}<=1.,\s\\n\\\n\s{\nposToString(\n{\ngoLeft}\s\\n)}\s.\s\"L:\",\s\\n\"\"\s\\n)\n\sgotoif(\nloop1,\s\\nlen(\nqueue\s\\n)>0&&curPos!=leon.adventure.target_pos\s\\n)\nloop2:\n\spath=sub(\nfield,\s\\nd2i(\ncurPos\s\\n),\s\\n1\s\\n)\s.\spath\n\scurPos=if(\nsub(\npath,\s\\n0,\s\\n1\s\\n)==\"U\",\s\\n{\ngoDown},\n\s\\nif(\nsub(\npath,\s\\n0,\s\\n1\s\\n)==\"D\",\s\\n{\ngoUp},\n\s\\n\\\n\sif(\nsub(\npath,\s\\n0,\s\\n1\s\\n)==\"R\",\s\\n{\ngoLeft},\n\s\\nif(\nsub(\npath,\s\\n0,\s\\n1\s\\n)==\"L\",\s\\n{\ngoRight},\n\s\\ncurPos\s\\n)\s\\n)\s\\n)\s\\n)\n\sgotoif(\nloop2,\s\\nsub(\nfield,\s\\nd2i(\ncurPos\s\\n),\s\\n1\s\\n)!=\"S\"\s\\n)\nleon.adventure.path\s=\sif(\npath==\"S\",\s\\n\"\",\s\\npath\s\\n)\nexecutesync(\n\"{\npackage}:refine\spath\"\s\\n)\nend:\nwait(\n0.0\s\\n)},\n{\n"refine\spath":{\n:import\sadventure_lib\n:name\s{\npackage}:refine\spath\n\n:global\sstring\sleon.adventure.path\n\n:local\sstring\spath\n:local\sdouble\scurPos\n:local\sint\sstepCount\n\n\n#nextVec(\nd\s\\n)\s{\nposToVec(\ncurPos\s\\n)}\s+\svec(\ns2d(\nsub(\n\"1102\",\s\\nindex(\n\"UDLR\",\s\\n{\nd},\n\s\\n0\s\\n),\s\\n1\s\\n),\s\\n0.\s\\n),\s\\ns2d(\nsub(\n\"2011\",\s\\nindex(\n\"UDLR\",\s\\n{\nd},\n\s\\n0\s\\n),\s\\n1\s\\n),\s\\n0.\s\\n)\s\\n)\s-\svec(\n1.,\s\\n1.\s\\n)\n\n#curDirection\ssub(\npath,\s\\nstepCount,\s\\n1\s\\n)\n\n#insert(\nst,\s\\ni,\s\\nval\s\\n)\ssub(\n{\nst},\n\s\\n0,\s\\n{\ni}\s\\n)\s.\s(\n{\nval}\s\\n)\s.\ssub(\n{\nst},\n{\ni},\n\s\\n99999\s\\n)\n\n#inverse(\nd\s\\n)\sternary.string(\n{\nd}==\"U\",\s\\n\"D\",\s\\nternary.string(\n{\nd}==\"D\",\s\\n\"U\",\s\\n\\\n\sternary.string(\n{\nd}==\"R\",\s\\n\"L\",\s\\n\"R\"\s\\n)\s\\n)\s\\n)\n\n#getEntity(\npos\s\\n)\sadventure.entityType(\n{\nposToVec(\n{\npos}\s\\n)}\s\\n)\n\n#getCurrentEntity\sadventure.entityType(\n{\nnextVec(\n{\ncurDirection}\s\\n)}\s\\n)\n\n#escapeDirection\sif(\n\\\n\s{\ngetEntity(\n{\ngoUp}\s\\n)}\s==\s\"\"\s&&\s\\\n\s{\ngetEntity(\ncurPos\s+\s19.\s*\s2.\s\\n)}\s==\s\"\"\s&&\s\\\n\s(\nfalse\s==\sadventure.isWall(\n{\nposToVec(\n{\ngoUp}\s\\n)}\s\\n)\s\\n)\s&&\\\n\s{\ngoUp}\s!=\s351.,\s\\n\\\n\s\"BUUWDD\",\s\\nif(\n\\\n\s{\ngetEntity(\n{\ngoDown}\s\\n)}==\"\"\s&&\s\\\n\s{\ngetEntity(\ncurPos\s-\s19.\s*\s2.\s\\n)}\s==\s\"\"\s&&\s\\\n\s(\nfalse\s==\sadventure.isWall(\n{\nposToVec(\n{\ngoDown}\s\\n)}\s\\n)\s\\n)\s&&\\\n\s{\ngoDown}\s!=\s9.,\s\\n\\\n\s\"BDDWUU\",\s\\nif(\n\\\n\s{\ngetEntity(\n{\ngoLeft}\s\\n)}\s==\s\"\"\s&&\s\\\n\s{\ngetEntity(\ncurPos\s-\s2.\s\\n)}\s==\s\"\"\s&&\s\\\n\s(\nfalse\s==\sadventure.isWall(\n{\nposToVec(\n{\ngoLeft}\s\\n)}\s\\n)\s\\n)\s&&\\\n\s{\ngoLeft}\s!=\s171.,\s\\n\\\n\s\"BLLWRR\",\s\\n\"BRRWLL\"\s\\n)\s\\n)\s\\n)\n\nstart:\ncurPos=x(\nadventure.playerPos(\n\s\\n)\s\\n)+19.*y(\nadventure.playerPos(\n\s\\n)\s\\n)\nstepCount\s=\s0\npath=leon.adventure.path\nloop:\ngoto(\nif(\nstepCount>=len(\npath\s\\n),\s\\nend,\s\\nif(\n\\\n\s{\ngetCurrentEntity}\s==\s\"Door\",\s\\ndoor,\s\\n\\\n\sif(\n{\ngetCurrentEntity}\s==\s\"Rock\",\s\\nif(\nadventure.hasItem(\n\"hammer\"\s\\n),\s\\ndoor,\s\\nrock\s\\n),\s\\nnextTile\s\\n)\s\\n)\s\\n)\s\\n)\nrock:\n\spath\s=\s{\ninsert(\npath,\s\\nstepCount,\s\\nif(\nadventure.hasItem(\n\"eodArmor\"\s\\n),\s\\n\"BWWW\",\s\\n{\nescapeDirection}\s\\n)\s\\n)}\n\sstepCount+=if(\nadventure.hasItem(\n\"eodArmor\"\s\\n),\s\\n4,\s\\n6\s\\n)\n\sgoto(\nnextTile\s\\n)\ndoor:\n\spath={\ninsert(\npath,\s\\nstepCount,\s\\n{\ncurDirection}\s\\n)}\n\sstepCount+=1\nnextTile:\n\scurPos={\nnextField(\n{\ncurDirection}\s\\n)}\n\sstepCount+=1\n\sgoto(\nloop\s\\n)\nend:\n\sleon.adventure.path\s=\spath\n\swait(\n0.\s\\n)},\n{\n"kill\senemies":{\n:import\sadventure_lib\n:name\s{\npackage}:kill\senemies\n\n\n#enemies_alive\s(\n{\nlua(\n\\\n\slocal\spositions\s=\s{\n}\s\\\n\slocal\scounter\s=\s1\s\\\n\sfor\sx=1,\s\\n17,\s\\n1\sdo\s\\\n\sfor\sy=1,\s\\n17,\s\\n1\sdo\s\\\n\sif\snot(\nx%2==0\sand\sy%2==0\s\\n)\sthen\s\\\n\spositions{\ncounter}=\"adventure.isEnemy(\nvec(\n\"..x..\".,\s\\n\"..y..\".\s\\n)\s\\n)\"\s\\\n\scounter\s=\scounter\s+\s1\s\\\n\send\s\\\n\send\s\\\n\send\s\\\n\spositions{\ncounter}=\"adventure.isEnemy(\nvec(\n0.,\s\\n9.\s\\n)\s\\n)\"\s\\\n\spositions{\ncounter+1}=\"adventure.isEnemy(\nvec(\n9.,\s\\n0.\s\\n)\s\\n)\"\s\\\n\spositions{\ncounter+2}=\"adventure.isEnemy(\nvec(\n9.,\s\\n18.\s\\n)\s\\n)\"\s\\\n\spositions{\ncounter+3}=\"adventure.isEnemy(\nvec(\n18.,\s\\n9.\s\\n)\s\\n)\"\s\\\n\sreturn\stable.concat(\npositions,\s\\n\"||\"\s\\n)\s\s\\n)}\s\\n)\n\n\n#enemyInDir(\nx,\s\\ny\s\\n)\sadventure.isEnemy(\nadventure.playerPos(\n\s\\n)\s+\svec(\n{\nx},\n{\ny}\s\\n)\s\\n)\n\n#enemyDirection\sif(\n{\nenemyInDir(\n0.,\s\\n1.\s\\n)},\n\s\\n\"U\",\s\\n\\\n\sif(\n{\nenemyInDir(\n1.,\s\\n0.\s\\n)},\n\s\\n\"R\",\s\\n\\\n\sif(\n{\nenemyInDir(\n0.,\s\\n-1.\s\\n)},\n\s\\n\"D\",\s\\n\\\n\sif(\n{\nenemyInDir(\n-1.,\s\\n0.\s\\n)},\n\s\\n\"L\",\s\\n\"W\"\s\\n)\s\\n)\s\\n)\s\\n)\n\nkey.k(\n\s\\n)\n\nisopen(\n\"arcade\"\s\\n)\n\ngotoif(\nstart,\s\\nimpulse(\n\s\\n)!=\"key.k\"\s\\n)\nexecutesync(\n\"turbo\sstart\"\s\\n)\nstart:\ngoto(\nternary.int(\n{\nenemies_alive},\n\s\\nwait,\s\\nternary.int(\nimpulse(\n\s\\n)==\"key.k\",\s\\nstop,\s\\nend\s\\n)\s\\n)\s\\n)\nwait:\n\sexecutesync(\n\"turbo\sstop\"\s\\n)\n\sadventure.wait(\n\s\\n)\n\sexecutesync(\n\"turbo\sstart\"\s\\n)\n\sgotoif(\nwait,\s\\n{\nenemyDirection}==\"W\"\s\\n)\nattack:\n\sexecutesync(\n\"turbo\sstop\"\s\\n)\n\sadventure.move(\n{\nmove(\n{\nenemyDirection}\s\\n)}\s\\n)\n\sexecutesync(\n\"turbo\sstart\"\s\\n)\n\sgoto(\nternary.int(\n{\nenemyDirection}!=\"W\",\s\\nattack,\s\\nstart\s\\n)\s\\n)\nstop:\n\sexecutesync(\n\"turbo\sstop\"\s\\n)\nend:\nwait(\n0.\s\\n)},\n{\n"find\sloot":{\n:import\sadventure_lib\n:name\s{\npackage}:find\sloot\n\n:global\sdouble\sleon.adventure.target_pos\n:global\sint\sturbo.cycles.max\n:global\sint\sturbo.cycles\n:global\sint\sleon.adventure.running\n:global\sstring\sleon.adventure.targetPositions\n:global\sint\sleon.adventure.maxDifficulty\n\nkey.u(\n\s\\n)\nkey.j(\n\s\\n)\n\nisopen(\n\"arcade\"\s\\n)\n\nleon.adventure.maxDifficulty\s=\sleon.adventure.maxDifficulty\s+\sif(\nimpulse(\n\s\\n)==\"key.j\",\s\\n-1,\s\\nif(\nimpulse(\n\s\\n)==\"key.u\",\s\\n1,\s\\n0\s\\n)\s\\n)\ngotoif(\nend,\s\\ncontains(\nimpulse(\n\s\\n),\s\\n\"key.\"\s\\n)\s\\n)\n\nstart:\nturbo.cycles.max\s=\smax(\nturbo.cycles.max,\s\\nturbo.cycles\s+\s4000\s\\n)\nexecutesync(\n\"{\npackage}:analyze\sloot\"\s\\n)\nloop:\n\sleon.adventure.target_pos\s=\ss2d(\nsub(\nleon.adventure.targetPositions,\s\\n0,\s\\n3\s\\n),\s\\n0.\s\\n)\n\sleon.adventure.targetPositions\s=\ssub(\nleon.adventure.targetPositions,\s\\n4,\s\\n99999\s\\n)\n\sexecutesync(\n\"{\npackage}:find\spath\"\s\\n)\n\sexecutesync(\n\"{\npackage}:follow\spath\"\s\\n)\n\sgotoif(\nloop,\s\\nlen(\nleon.adventure.targetPositions\s\\n)>0&&leon.adventure.running>0\s\\n)\nend:\nwait(\n0.\s\\n)},\n{\n"farm\skeys":{\n:import\sadventure_lib\n:name\s{\npackage}:farm\skeys\n\n:global\sstring\sleon.adventure.path\n:global\sint\sleon.adventure.running\n\n:local\sint\scurPos\n\nstart:\ncurPos=d2i(\nx(\nadventure.playerPos(\n\s\\n)\s\\n)\s\\n)+a.i(\n19,\s\\n\"*\",\s\\nd2i(\ny(\nadventure.playerPos(\n\s\\n)\s\\n)\s\\n)\s\\n)\ngotoif(\nend,\s\\nadventure.keys(\n\s\\n)\s>\s10\s||\s(\n(\n(\ncurPos\s!=\s9\s\\n)\s&&\s(\ncurPos\s!=\s189\s\\n)\s\\n)\s&&\s(\n(\ncurPos\s!=\s171\s\\n)\s&&\s(\ncurPos!=351\s\\n)\s\\n)\s\\n)||leon.adventure.running!=1\s\\n)\nleon.adventure.path\s=\sternary.string(\ncurPos==9,\s\\n\"D\",\s\\nternary.string(\ncurPos==171,\s\\n\"L\",\s\\nternary.string(\ncurPos==189,\s\\n\"R\",\s\\n\"U\"\s\\n)\s\\n)\s\\n)\nexecutesync(\n\"leon.adventure:follow\spath\"\s\\n)\nexecutesync(\n\"leon.adventure:kill\senemies\"\s\\n)\nleon.adventure.path\s=\sternary.string(\ncurPos==9,\s\\n\"U\",\s\\nternary.string(\ncurPos==171,\s\\n\"R\",\s\\nternary.string(\ncurPos==189,\s\\n\"L\",\s\\n\"D\"\s\\n)\s\\n)\s\\n)\nexecutesync(\n\"leon.adventure:follow\spath\"\s\\n)\nexecutesync(\n\"leon.adventure:kill\senemies\"\s\\n)\ngoto(\nstart\s\\n)\nend:\nwait(\n0.\s\\n)},\n{\n"analyze\sloot":{\n:import\sadventure_lib\n:name\s{\npackage}:analyze\sloot\n\n:global\sstring\sleon.adventure.targetPositions\n\n:local\sstring\sfield\n:local\sstring\squeue\n:local\sdouble\scurPos\n:local\sdouble\stargetPos\n:local\sstring\sinsertPosition\n:local\sstring\slootPositions\n\n\n#toQueueElement(\npos,\s\\ndir\s\\n)\s{\nposToString(\n{\npos}\s\\n)}\s.\s{\ndir}\s.\s\":\"\n\n#enqueue(\npos,\s\\ndir\s\\n)\squeue=queue\s.\s{\ntoQueueElement(\n{\npos},\n{\ndir}\s\\n)}\n\n{\nenqueue(\nx(\nadventure.playerPos(\n\s\\n)\s\\n)+\s19.\s*\sy(\nadventure.playerPos(\n\s\\n)\s\\n),\s\\n\"S\"\s\\n)}\nfield\s=\s\"{\nlua(\nreturn\sstring.rep(\n\"0000\",\s\\n362\s\\n)\s\\n)}\"\nloop1:\n\scurPos\s=\s{\nfirstElementPos}\n\sfield\s=\s{\nreplace(\nfield,\s\\nd2i(\ncurPos\s\\n)*4,\s\\n{\nfirstElementDir},\n\s\\n1\s\\n)}\n\s{\npop}\n\squeue=\squeue\s.\sif(\nfalse\s==\sadventure.isWall(\n{\nposToVec(\n{\ngoUp}\s\\n)}\s\\n)\s&&\s\\\n\sfalse\s==\scontains(\nqueue,\s\\n{\nposToString(\n{\ngoUp}\s\\n)}\s\\n)\s&&\s\\\n\s{\ngoUp}<361.\s&&\\\n\ssub(\nfield,\s\\nd2i(\n{\ngoUp}\s\\n)*4,\s\\n1\s\\n)==\"0\"\s,\s\\n\\\n\s{\nposToString(\n{\ngoUp}\s\\n)}\s.\s\"U:\",\s\\n\"\"\s\\n)\s.\s\\\n\sif(\nfalse\s==\sadventure.isWall(\n{\nposToVec(\n{\ngoDown}\s\\n)}\s\\n)\s&&\s\\\n\sfalse\s==\scontains(\nqueue,\s\\n{\nposToString(\n{\ngoDown}\s\\n)}\s\\n)\s&&\s\\\n\s{\ngoDown}>=0.\s&&\\\n\ssub(\nfield,\s\\nd2i(\n{\ngoDown}\s\\n)*4,\s\\n1\s\\n)==\"0\"\s,\s\\n\\\n\s{\nposToString(\n{\ngoDown}\s\\n)}\s.\s\"D:\",\s\\n\"\"\s\\n)\s.\\\n\sif(\nfalse\s==\sadventure.isWall(\n{\nposToVec(\n{\ngoRight}\s\\n)}\s\\n)\s&&\s\\\n\sfalse\s==\scontains(\nqueue,\s\\n{\nposToString(\n{\ngoRight}\s\\n)}\s\\n)\s&&\s\\\n\ssub(\nfield,\s\\nd2i(\n{\ngoRight}\s\\n)*4,\s\\n1\s\\n)==\"0\"&&\\\n\sfloor(\n{\ngoRight}/19.\s\\n)==floor(\ncurPos/19.\s\\n),\s\\n\\\n\s{\nposToString(\n{\ngoRight}\s\\n)}\s.\s\"R:\",\s\\n\"\"\s\\n)\s.\\\n\sif(\nfalse\s==\sadventure.isWall(\n{\nposToVec(\n{\ngoLeft}\s\\n)}\s\\n)\s&&\s\\\n\sfalse\s==\scontains(\nqueue,\s\\n{\nposToString(\n{\ngoLeft}\s\\n)}\s\\n)\s&&\s\\\n\ssub(\nfield,\s\\nd2i(\n{\ngoLeft}\s\\n)*4,\s\\n1\s\\n)\s==\s\"0\"&&\\\n\sfloor(\n{\ngoLeft}/19.\s\\n)==floor(\ncurPos/19.\s\\n),\s\\n\\\n\s{\nposToString(\n{\ngoLeft}\s\\n)}\s.\s\"L:\",\s\\n\"\"\s\\n)\n\slootPositions\s=\sif(\n\\\n\sadventure.entityType(\n{\nposToVec(\ncurPos\s\\n)}\s\\n)==\"Chest\",\s\\n\\\n\s{\nposToString(\ncurPos\s\\n)}\s.\s\":\",\s\\n\\\n\s\"\"\s\\n)\s.\slootPositions\n\sgotoif(\nloop1,\s\\nlen(\nqueue\s\\n)>0\s\\n)\nlootPositions\s=\sleon.adventure.targetPositions\s.\slootPositions\nloop2:\n\stargetPos\s=\ss2d(\nsub(\nlootPositions,\s\\n0,\s\\n3\s\\n),\s\\n0.\s\\n)\n\scurPos\s=\stargetPos\n\slootPositions\s=\ssub(\nlootPositions,\s\\n4,\s\\n99999\s\\n)\n\sinnerLoop2:\n\sleon.adventure.targetPositions\s=\sif(\n\\\n\ssub(\nfield,\s\\nd2i(\n{\nnextFieldInverse(\nsub(\nfield,\s\\nd2i(\ncurPos\s\\n)*4,\s\\n1\s\\n)\s\\n)}\s\\n)\s*\s4,\s\\n1\s\\n)\s==\s\"S\"\\\n\s&&\sfalse\s==\scontains(\nleon.adventure.targetPositions,\s\\n{\nposToString(\ntargetPos\s\\n)}\s\\n),\s\\n\\\n\s{\nposToString(\ntargetPos\s\\n)}\s.\s\":\"\s.\sleon.adventure.targetPositions,\s\\n\\\n\sif(\n\\\n\sfalse\s==\scontains(\nleon.adventure.targetPositions,\s\\n{\nposToString(\ntargetPos\s\\n)}\s\\n)\s\\\n\s&&\ssub(\nfield,\s\\nd2i(\ncurPos\s\\n)*4+1,\s\\n3\s\\n)\s!=\s\"000\",\s\\n\\\n\ssub(\n\\\n\sleon.adventure.targetPositions,\s\\n\\\n\s0,\s\\n\\\n\sindex(\nleon.adventure.targetPositions,\s\\nsub(\nfield,\s\\nd2i(\ncurPos\s\\n)*4+1,\s\\n3\s\\n),\s\\n0\s\\n)\\\n\s\s\\n)\s.\s{\nposToString(\ntargetPos\s\\n)}\s.\s\":\"\s.\\\n\ssub(\n\\\n\sleon.adventure.targetPositions,\s\\n\\\n\sindex(\nleon.adventure.targetPositions,\s\\nsub(\nfield,\s\\nd2i(\ncurPos\s\\n)*4+1,\s\\n3\s\\n),\s\\n0\s\\n),\s\\n\\\n\s99999\\\n\s\s\\n),\s\\n\\\n\sleon.adventure.targetPositions\\\n\s\s\\n)\\\n\s\s\\n)\n\sfield\s=\sif(\nfalse==contains(\nleon.adventure.targetPositions,\s\\n{\nposToString(\ntargetPos\s\\n)}\s\\n)\s||\\\n\slen(\nleon.adventure.targetPositions\s\\n)\s<=\s4\s||\ssub(\nfield,\s\\nd2i(\ncurPos\s\\n)*4+1,\s\\n3\s\\n)==sub(\nleon.adventure.targetPositions,\s\\nindex(\nleon.adventure.targetPositions,\s\\n{\nposToString(\ntargetPos\s\\n)},\n\s\\n0\s\\n)+4,\s\\n3\s\\n),\s\\n\\\n\s{\nreplace(\nfield,\s\\nd2i(\ncurPos\s\\n)*4+1,\s\\n{\nposToString(\ntargetPos\s\\n)},\n\s\\n3\s\\n)},\n\s\\nfield\s\\n)\n\scurPos\s=\s{\nnextFieldInverse(\nsub(\nfield,\s\\nd2i(\ncurPos\s\\n)*4,\s\\n1\s\\n)\s\\n)}\n\sgoto(\nif(\nsub(\nfield,\s\\nd2i(\ncurPos\s\\n)*4,\s\\n1\s\\n)!=\"S\",\s\\ninnerLoop2,\s\\nif(\nlen(\nlootPositions\s\\n)>0,\s\\nloop2,\s\\nend\s\\n)\s\\n)\s\\n)\nend:\n\swait(\n0.\s\\n)}}}}